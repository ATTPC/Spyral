
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Spyral AT-TPC analysis framework">
      
      
      
        <link rel="canonical" href="https://example.com/api/trace/frib_event/">
      
      
        <link rel="prev" href="../get_trace/">
      
      
        <link rel="next" href="../frib_trace/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>frib_event - Spyral</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frib_event-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Spyral" class="md-header__button md-logo" aria-label="Spyral" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spyral
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              frib_event
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/turinath/Spyral/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Spyral" class="md-nav__button md-logo" aria-label="Spyral" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Spyral
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/turinath/Spyral/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About Configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/detector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/traces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GET & FRIB Traces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/estimate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/config/extending/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending the Config
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Analysis Phases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Analysis Phases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/phases/about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About Phases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/phases/point_cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Point Cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/phases/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/phases/estimate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/phases/solve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solve
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/numba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numba
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel Processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/notebooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/continuing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    After Spyral
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spyral Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../run_parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run_parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../phase_pointcloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phase_pointcloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../phase_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phase_cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../phase_estimate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phase_estimate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../phase_solve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phase_solve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/clusterize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    clusterize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/estimator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    estimator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/hardware_id/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hardware_id
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/pad_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pad_map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/point_cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    point_cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/spy_log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spy_log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/track_generator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    track_generator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/workspace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    workspace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/legacy_beam_pads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    legacy_beam_pads
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    correction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            correction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../correction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About correction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../correction/generate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../correction/electron_corrector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    electron_corrector
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    geometry
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            geometry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geometry/circle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    circle
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    interpolate
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            interpolate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../interpolate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About interpolate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../interpolate/bilinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bilinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../interpolate/linear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../interpolate/track_interpolator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    track_interpolator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    parallel
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            parallel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel/run_stack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run_stack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel/status_message/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    status_message
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    solvers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            solvers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solvers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About solvers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solvers/guess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    guess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../solvers/solver_interp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    solver_interp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" checked>
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    trace
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            trace
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About trace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get_event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_legacy_event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get_legacy_event
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_trace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get_trace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    frib_event
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    frib_event
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spyral.trace.frib_event" class="md-nav__link">
    <span class="md-ellipsis">
      frib_event
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent" class="md-nav__link">
    <span class="md-ellipsis">
      FribEvent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FribEvent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.correct_ic_time" class="md-nav__link">
    <span class="md-ellipsis">
      correct_ic_time()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_good_ic_peak" class="md-nav__link">
    <span class="md-ellipsis">
      get_good_ic_peak()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_ic_multiplicity" class="md-nav__link">
    <span class="md-ellipsis">
      get_ic_multiplicity()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_ic_trace" class="md-nav__link">
    <span class="md-ellipsis">
      get_ic_trace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_mesh_trace" class="md-nav__link">
    <span class="md-ellipsis">
      get_mesh_trace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_si_trace" class="md-nav__link">
    <span class="md-ellipsis">
      get_si_trace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_triggering_ic_peak" class="md-nav__link">
    <span class="md-ellipsis">
      get_triggering_ic_peak()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.preprocess_frib_traces" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_frib_traces()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frib_trace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frib_trace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../peak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    peak
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../for_devs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    For Developers
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spyral.trace.frib_event" class="md-nav__link">
    <span class="md-ellipsis">
      frib_event
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent" class="md-nav__link">
    <span class="md-ellipsis">
      FribEvent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FribEvent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.correct_ic_time" class="md-nav__link">
    <span class="md-ellipsis">
      correct_ic_time()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_good_ic_peak" class="md-nav__link">
    <span class="md-ellipsis">
      get_good_ic_peak()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_ic_multiplicity" class="md-nav__link">
    <span class="md-ellipsis">
      get_ic_multiplicity()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_ic_trace" class="md-nav__link">
    <span class="md-ellipsis">
      get_ic_trace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_mesh_trace" class="md-nav__link">
    <span class="md-ellipsis">
      get_mesh_trace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_si_trace" class="md-nav__link">
    <span class="md-ellipsis">
      get_si_trace()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.FribEvent.get_triggering_ic_peak" class="md-nav__link">
    <span class="md-ellipsis">
      get_triggering_ic_peak()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spyral.trace.frib_event.preprocess_frib_traces" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_frib_traces()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="frib_event-module">frib_event Module</h1>
<p>Defines the event structure from the FRIBDAQ data.</p>


<div class="doc doc-object doc-module">



<a id="spyral.trace.frib_event"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="spyral.trace.frib_event.FribEvent" class="doc doc-heading">
          <code>FribEvent</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Represents an event from the FRIBDAQ system.</p>
<p>Contains traces from the SIS3300 module, typically encompassing the ion chamber,
silicon detector, and mesh signals.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>event_number</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The event number</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>event_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The event name</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>trace_data</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="spyral.trace.frib_trace.FribTrace" href="../frib_trace/#spyral.trace.frib_trace.FribTrace">FribTrace</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The traces in the event</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code>FribEvent</code></td>
            <td>
              <div class="doc-md-description">
                <p>Construct the FribEvent and process the traces</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>get_ic_trace</code></td>
            <td>
              <div class="doc-md-description">
                <p>Get the ion chamber trace for this event</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>get_si_trace</code></td>
            <td>
              <div class="doc-md-description">
                <p>Get the silicon trace for this event</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>get_mesh_trace</code></td>
            <td>
              <div class="doc-md-description">
                <p>Get the mesh trace for this event</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>get_good_ic_peak</code></td>
            <td>
              <div class="doc-md-description">
                <p>Attempts to retrieve the "good" ion chamber signal.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code>correct_ic_time</code></td>
            <td>
              <div class="doc-md-description">
                <p>Calculate the correction to the GET time buckets using the ion chamber signal</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FribEvent</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an event from the FRIBDAQ system.</span>

<span class="sd">    Contains traces from the SIS3300 module, typically encompassing the ion chamber,</span>
<span class="sd">    silicon detector, and mesh signals.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    event_number: int</span>
<span class="sd">        The event number</span>
<span class="sd">    event_name: str</span>
<span class="sd">        The event name</span>
<span class="sd">    trace_data: list[FribTrace]</span>
<span class="sd">        The traces in the event</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    FribEvent(self, raw_data: h5.Dataset, event_number: int, params: FribParameters)</span>
<span class="sd">        Construct the FribEvent and process the traces</span>
<span class="sd">    get_ic_trace() -&gt; FribTrace</span>
<span class="sd">        Get the ion chamber trace for this event</span>
<span class="sd">    get_si_trace() -&gt; FribTrace</span>
<span class="sd">        Get the silicon trace for this event</span>
<span class="sd">    get_mesh_trace() -&gt; FribTrace</span>
<span class="sd">        Get the mesh trace for this event</span>
<span class="sd">    get_good_ic_peak(params: FribParameters) -&gt; Peak | None</span>
<span class="sd">        Attempts to retrieve the &quot;good&quot; ion chamber signal.</span>
<span class="sd">    correct_ic_time(good_peak: Peak, get_frequency: float) -&gt; float</span>
<span class="sd">        Calculate the correction to the GET time buckets using the ion chamber signal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">:</span> <span class="n">h5</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">event_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the FribEvent and process the traces.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        raw_data: h5py.Dataset</span>
<span class="sd">            The hdf5 dataset containing the FRIBDAQ traces</span>
<span class="sd">        event_number: int</span>
<span class="sd">            The event number</span>
<span class="sd">        params: FribParameters</span>
<span class="sd">            The configuration parameters for FRIBDAQ signal analysis</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FribEvent</span>
<span class="sd">            An instance of FribEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_number</span> <span class="o">=</span> <span class="n">event_number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">trace_data</span> <span class="o">=</span> <span class="n">preprocess_frib_traces</span><span class="p">(</span>
            <span class="n">raw_data</span><span class="p">[:]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">params</span><span class="o">.</span><span class="n">baseline_window_scale</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="p">[</span><span class="n">FribTrace</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">trace_data</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_ic_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FribTrace</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the ion chamber trace for this event</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FribTrace</span>
<span class="sd">            The ion chamber trace</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">IC_COLUMN</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_si_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FribTrace</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the silicon trace for this event</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FribTrace</span>
<span class="sd">            The silicon trace</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">SI_COLUMN</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_mesh_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FribTrace</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mesh trace for this event</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FribTrace</span>
<span class="sd">            The mesh trace</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">MESH_COLUMN</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_triggering_ic_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Peak</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attempts to retrieve the triggering ion chamber peak</span>

<span class="sd">        The ion chamber signal is delayed relative to the mesh signal. This means that the signal</span>
<span class="sd">        recorded in the FRIBDAQ contains times (time buckets) from before the event window is actually open.</span>
<span class="sd">        As such, we cannot rely on the first peak of the ion chamber being the triggering peak. To correct for</span>
<span class="sd">        this we have a parameter `ic_delay_time_bucket` which essentially sets a threshold on peak centroid.</span>
<span class="sd">        All peaks before this time bucket are ignored, and the first peak after the time bucket is the triggering</span>
<span class="sd">        peak.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params: FribParameters</span>
<span class="sd">            Configuration parameters taht control the algorithm</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Peak | None</span>
<span class="sd">            Returns the triggering peak or None if there is no triggering peak found (not good)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ic_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ic_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Sort the peaks in ascending order, so that the first one we find</span>
        <span class="c1"># greater than our delay is the trigger.</span>
        <span class="n">ic_sorted_peaks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">ic_sorted_peaks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">peak</span><span class="o">.</span><span class="n">centroid</span> <span class="o">&gt;</span> <span class="n">params</span><span class="o">.</span><span class="n">ic_delay_time_bucket</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">peak</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">get_ic_multiplicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the IC multiplicity, accounting for the ion chamber delay</span>

<span class="sd">        The ion chamber signal is delayed relative to the mesh signal. This means that the signal</span>
<span class="sd">        recorded in the FRIBDAQ contains times (time buckets) from before the event window is actually open.</span>
<span class="sd">        As such, we cannot rely on the first peak of the ion chamber being the triggering peak. To correct for</span>
<span class="sd">        this we have a parameter `ic_delay_time_bucket` which essentially sets a threshold on peak centroid.</span>
<span class="sd">        All peaks before this time bucket are ignored, and the first peak after the time bucket is the triggering</span>
<span class="sd">        peak. This method counts the number of peaks after the delay.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params: FribParameters</span>
<span class="sd">            Configuration parameters taht control the algorithm</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of IC peaks after the delay</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ic_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ic_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">ic_peaks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">peak</span><span class="o">.</span><span class="n">centroid</span> <span class="o">&gt;</span> <span class="n">params</span><span class="o">.</span><span class="n">ic_delay_time_bucket</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">count</span>

    <span class="k">def</span> <span class="nf">get_good_ic_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Peak</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attempts to retrieve the &quot;good&quot; ion chamber signal.</span>

<span class="sd">        There are several issues with determining the &quot;good&quot; ion chamber signal.</span>

<span class="sd">        First, we must identify the triggering peak, which is handled through the `get_triggering_ic_peak` method.</span>

<span class="sd">        Then, in many cases, the ion chamber has multiple peaks due to bunches of beam being delivered to the AT-TPC and</span>
<span class="sd">        the AT-TPC&#39;s long event window. This poses an issue for the analysis; we must now deterimine which ion chamber signal to use,</span>
<span class="sd">        if any, for this event. The algorithm below uses the silicon signal to veto ion chamber signals which correspond</span>
<span class="sd">        to un-reacted beam particles and effectively reduce the multiplicity. The user then has control over how many ion chamber</span>
<span class="sd">        signals are allowed for a good event. In general, AT-TPC would only accept multiplicty one type events.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params: FribParameters</span>
<span class="sd">            Configuration parameters that control the algorithm</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[int, Peak] | None</span>
<span class="sd">            Returns None on failure to find any good ion chamber signal; otherwise returns the good ion chamber multiplicity and the first Peak associated with a good signal</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_triggering_ic_peak</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="c1"># No trigger, exit</span>
        <span class="k">if</span> <span class="n">trigger</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">ic_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ic_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>
        <span class="n">si_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_si_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">si_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ic_peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="n">good_ic_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">good_ic_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">si_coinc</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">):</span>
            <span class="c1"># Ignore peaks before the trigger</span>
            <span class="k">if</span> <span class="n">ic</span><span class="o">.</span><span class="n">centroid</span> <span class="o">&lt;</span> <span class="n">trigger</span><span class="o">.</span><span class="n">centroid</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">si_coinc</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">si_peaks</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">si</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">50.0</span><span class="p">:</span>
                    <span class="n">si_coinc</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">si_coinc</span><span class="p">:</span>
                <span class="n">good_ic_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">good_ic_index</span> <span class="o">=</span> <span class="n">idx</span>

        <span class="k">if</span> <span class="n">good_ic_count</span> <span class="o">&gt;</span> <span class="n">params</span><span class="o">.</span><span class="n">ic_multiplicity</span> <span class="ow">or</span> <span class="n">good_ic_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">good_ic_count</span><span class="p">,</span> <span class="n">ic_peaks</span><span class="p">[</span><span class="n">good_ic_index</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">correct_ic_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">good_peak</span><span class="p">:</span> <span class="n">Peak</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">,</span> <span class="n">get_frequency</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the correction to the GET time buckets using the ion chamber signal</span>

<span class="sd">        In a case where the ion chamber fired multiple times, somtimes the wrong</span>
<span class="sd">        beam particle starts the event. That is: we trigger on an unreacted beam particle,</span>
<span class="sd">        but still capture a good event within the trigger window. After the good ion</span>
<span class="sd">        chamber peak is identified using the get_good_ic_peak method, a correction</span>
<span class="sd">        for this time walk effect can be calculated by taking the difference between the</span>
<span class="sd">        centroids in the good peak and the earliest peak in the ion chamber trace.</span>
<span class="sd">        The difference can then be converted to GET time buckets by multiplying by the</span>
<span class="sd">        ratio of the sampling frequency of the GET system and the SIS3300 module.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        good_peak: Peak</span>
<span class="sd">            The good peak in the ion chamber trace, typically found using the get_good_ic_peak method</span>
<span class="sd">        params: FribParameters</span>
<span class="sd">            Configuration parameters that control the algorithm</span>
<span class="sd">        get_frequency: float</span>
<span class="sd">            The sampling frequency of the GET electronics</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The correction to the GET time in units of GET time buckets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_triggering_ic_peak</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trigger</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">good_peak</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">trigger</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span> <span class="o">*</span> <span class="n">get_frequency</span> <span class="o">/</span> <span class="n">SAMPLING_FREQUENCY</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">event_number</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct the FribEvent and process the traces.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>raw_data</code></td>
          <td>
                <code><span title="h5py.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The hdf5 dataset containing the FRIBDAQ traces</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>event_number</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The event number</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>params</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.core.config.FribParameters" href="../../core/config/#spyral.core.config.FribParameters">FribParameters</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The configuration parameters for FRIBDAQ signal analysis</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.trace.frib_event.FribEvent" href="#spyral.trace.frib_event.FribEvent">FribEvent</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of FribEvent</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">:</span> <span class="n">h5</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">event_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the FribEvent and process the traces.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    raw_data: h5py.Dataset</span>
<span class="sd">        The hdf5 dataset containing the FRIBDAQ traces</span>
<span class="sd">    event_number: int</span>
<span class="sd">        The event number</span>
<span class="sd">    params: FribParameters</span>
<span class="sd">        The configuration parameters for FRIBDAQ signal analysis</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    FribEvent</span>
<span class="sd">        An instance of FribEvent</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_number</span> <span class="o">=</span> <span class="n">event_number</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw_data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">trace_data</span> <span class="o">=</span> <span class="n">preprocess_frib_traces</span><span class="p">(</span>
        <span class="n">raw_data</span><span class="p">[:]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">params</span><span class="o">.</span><span class="n">baseline_window_scale</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">traces</span> <span class="o">=</span> <span class="p">[</span><span class="n">FribTrace</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">trace_data</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.correct_ic_time" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">correct_ic_time</span><span class="p">(</span><span class="n">good_peak</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">get_frequency</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculate the correction to the GET time buckets using the ion chamber signal</p>
<p>In a case where the ion chamber fired multiple times, somtimes the wrong
beam particle starts the event. That is: we trigger on an unreacted beam particle,
but still capture a good event within the trigger window. After the good ion
chamber peak is identified using the get_good_ic_peak method, a correction
for this time walk effect can be calculated by taking the difference between the
centroids in the good peak and the earliest peak in the ion chamber trace.
The difference can then be converted to GET time buckets by multiplying by the
ratio of the sampling frequency of the GET system and the SIS3300 module.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>good_peak</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.trace.get_trace.Peak" href="../peak/#spyral.trace.peak.Peak">Peak</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The good peak in the ion chamber trace, typically found using the get_good_ic_peak method</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>params</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.core.config.FribParameters" href="../../core/config/#spyral.core.config.FribParameters">FribParameters</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration parameters that control the algorithm</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>get_frequency</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sampling frequency of the GET electronics</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The correction to the GET time in units of GET time buckets.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">correct_ic_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">good_peak</span><span class="p">:</span> <span class="n">Peak</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">,</span> <span class="n">get_frequency</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the correction to the GET time buckets using the ion chamber signal</span>

<span class="sd">    In a case where the ion chamber fired multiple times, somtimes the wrong</span>
<span class="sd">    beam particle starts the event. That is: we trigger on an unreacted beam particle,</span>
<span class="sd">    but still capture a good event within the trigger window. After the good ion</span>
<span class="sd">    chamber peak is identified using the get_good_ic_peak method, a correction</span>
<span class="sd">    for this time walk effect can be calculated by taking the difference between the</span>
<span class="sd">    centroids in the good peak and the earliest peak in the ion chamber trace.</span>
<span class="sd">    The difference can then be converted to GET time buckets by multiplying by the</span>
<span class="sd">    ratio of the sampling frequency of the GET system and the SIS3300 module.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    good_peak: Peak</span>
<span class="sd">        The good peak in the ion chamber trace, typically found using the get_good_ic_peak method</span>
<span class="sd">    params: FribParameters</span>
<span class="sd">        Configuration parameters that control the algorithm</span>
<span class="sd">    get_frequency: float</span>
<span class="sd">        The sampling frequency of the GET electronics</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        The correction to the GET time in units of GET time buckets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_triggering_ic_peak</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">trigger</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">good_peak</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">trigger</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span> <span class="o">*</span> <span class="n">get_frequency</span> <span class="o">/</span> <span class="n">SAMPLING_FREQUENCY</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.get_good_ic_peak" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_good_ic_peak</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Attempts to retrieve the "good" ion chamber signal.</p>
<p>There are several issues with determining the "good" ion chamber signal.</p>
<p>First, we must identify the triggering peak, which is handled through the <code>get_triggering_ic_peak</code> method.</p>
<p>Then, in many cases, the ion chamber has multiple peaks due to bunches of beam being delivered to the AT-TPC and
the AT-TPC's long event window. This poses an issue for the analysis; we must now deterimine which ion chamber signal to use,
if any, for this event. The algorithm below uses the silicon signal to veto ion chamber signals which correspond
to un-reacted beam particles and effectively reduce the multiplicity. The user then has control over how many ion chamber
signals are allowed for a good event. In general, AT-TPC would only accept multiplicty one type events.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>params</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.core.config.FribParameters" href="../../core/config/#spyral.core.config.FribParameters">FribParameters</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration parameters that control the algorithm</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[int, <a class="autorefs autorefs-internal" title="spyral.trace.get_trace.Peak" href="../peak/#spyral.trace.peak.Peak">Peak</a>] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Returns None on failure to find any good ion chamber signal; otherwise returns the good ion chamber multiplicity and the first Peak associated with a good signal</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_good_ic_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Peak</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Attempts to retrieve the &quot;good&quot; ion chamber signal.</span>

<span class="sd">    There are several issues with determining the &quot;good&quot; ion chamber signal.</span>

<span class="sd">    First, we must identify the triggering peak, which is handled through the `get_triggering_ic_peak` method.</span>

<span class="sd">    Then, in many cases, the ion chamber has multiple peaks due to bunches of beam being delivered to the AT-TPC and</span>
<span class="sd">    the AT-TPC&#39;s long event window. This poses an issue for the analysis; we must now deterimine which ion chamber signal to use,</span>
<span class="sd">    if any, for this event. The algorithm below uses the silicon signal to veto ion chamber signals which correspond</span>
<span class="sd">    to un-reacted beam particles and effectively reduce the multiplicity. The user then has control over how many ion chamber</span>
<span class="sd">    signals are allowed for a good event. In general, AT-TPC would only accept multiplicty one type events.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params: FribParameters</span>
<span class="sd">        Configuration parameters that control the algorithm</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[int, Peak] | None</span>
<span class="sd">        Returns None on failure to find any good ion chamber signal; otherwise returns the good ion chamber multiplicity and the first Peak associated with a good signal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">trigger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_triggering_ic_peak</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="c1"># No trigger, exit</span>
    <span class="k">if</span> <span class="n">trigger</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">ic_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ic_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>
    <span class="n">si_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_si_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">si_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ic_peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="n">good_ic_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">good_ic_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">si_coinc</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">):</span>
        <span class="c1"># Ignore peaks before the trigger</span>
        <span class="k">if</span> <span class="n">ic</span><span class="o">.</span><span class="n">centroid</span> <span class="o">&lt;</span> <span class="n">trigger</span><span class="o">.</span><span class="n">centroid</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">si_coinc</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">si_peaks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">si</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">50.0</span><span class="p">:</span>
                <span class="n">si_coinc</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">si_coinc</span><span class="p">:</span>
            <span class="n">good_ic_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">good_ic_index</span> <span class="o">=</span> <span class="n">idx</span>

    <span class="k">if</span> <span class="n">good_ic_count</span> <span class="o">&gt;</span> <span class="n">params</span><span class="o">.</span><span class="n">ic_multiplicity</span> <span class="ow">or</span> <span class="n">good_ic_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">good_ic_count</span><span class="p">,</span> <span class="n">ic_peaks</span><span class="p">[</span><span class="n">good_ic_index</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.get_ic_multiplicity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_ic_multiplicity</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Calculates the IC multiplicity, accounting for the ion chamber delay</p>
<p>The ion chamber signal is delayed relative to the mesh signal. This means that the signal
recorded in the FRIBDAQ contains times (time buckets) from before the event window is actually open.
As such, we cannot rely on the first peak of the ion chamber being the triggering peak. To correct for
this we have a parameter <code>ic_delay_time_bucket</code> which essentially sets a threshold on peak centroid.
All peaks before this time bucket are ignored, and the first peak after the time bucket is the triggering
peak. This method counts the number of peaks after the delay.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>params</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.core.config.FribParameters" href="../../core/config/#spyral.core.config.FribParameters">FribParameters</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration parameters taht control the algorithm</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of IC peaks after the delay</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_ic_multiplicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the IC multiplicity, accounting for the ion chamber delay</span>

<span class="sd">    The ion chamber signal is delayed relative to the mesh signal. This means that the signal</span>
<span class="sd">    recorded in the FRIBDAQ contains times (time buckets) from before the event window is actually open.</span>
<span class="sd">    As such, we cannot rely on the first peak of the ion chamber being the triggering peak. To correct for</span>
<span class="sd">    this we have a parameter `ic_delay_time_bucket` which essentially sets a threshold on peak centroid.</span>
<span class="sd">    All peaks before this time bucket are ignored, and the first peak after the time bucket is the triggering</span>
<span class="sd">    peak. This method counts the number of peaks after the delay.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params: FribParameters</span>
<span class="sd">        Configuration parameters taht control the algorithm</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        The number of IC peaks after the delay</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ic_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ic_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">ic_peaks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">peak</span><span class="o">.</span><span class="n">centroid</span> <span class="o">&gt;</span> <span class="n">params</span><span class="o">.</span><span class="n">ic_delay_time_bucket</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.get_ic_trace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_ic_trace</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the ion chamber trace for this event</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.trace.frib_trace.FribTrace" href="../frib_trace/#spyral.trace.frib_trace.FribTrace">FribTrace</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The ion chamber trace</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_ic_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FribTrace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the ion chamber trace for this event</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    FribTrace</span>
<span class="sd">        The ion chamber trace</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">IC_COLUMN</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.get_mesh_trace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_mesh_trace</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the mesh trace for this event</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.trace.frib_trace.FribTrace" href="../frib_trace/#spyral.trace.frib_trace.FribTrace">FribTrace</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The mesh trace</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_mesh_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FribTrace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the mesh trace for this event</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    FribTrace</span>
<span class="sd">        The mesh trace</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">MESH_COLUMN</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.get_si_trace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_si_trace</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the silicon trace for this event</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.trace.frib_trace.FribTrace" href="../frib_trace/#spyral.trace.frib_trace.FribTrace">FribTrace</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The silicon trace</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_si_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FribTrace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the silicon trace for this event</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    FribTrace</span>
<span class="sd">        The silicon trace</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traces</span><span class="p">[</span><span class="n">SI_COLUMN</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="spyral.trace.frib_event.FribEvent.get_triggering_ic_peak" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_triggering_ic_peak</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Attempts to retrieve the triggering ion chamber peak</p>
<p>The ion chamber signal is delayed relative to the mesh signal. This means that the signal
recorded in the FRIBDAQ contains times (time buckets) from before the event window is actually open.
As such, we cannot rely on the first peak of the ion chamber being the triggering peak. To correct for
this we have a parameter <code>ic_delay_time_bucket</code> which essentially sets a threshold on peak centroid.
All peaks before this time bucket are ignored, and the first peak after the time bucket is the triggering
peak.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>params</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.core.config.FribParameters" href="../../core/config/#spyral.core.config.FribParameters">FribParameters</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration parameters taht control the algorithm</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="spyral.trace.get_trace.Peak" href="../peak/#spyral.trace.peak.Peak">Peak</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Returns the triggering peak or None if there is no triggering peak found (not good)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_triggering_ic_peak</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">FribParameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Peak</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Attempts to retrieve the triggering ion chamber peak</span>

<span class="sd">    The ion chamber signal is delayed relative to the mesh signal. This means that the signal</span>
<span class="sd">    recorded in the FRIBDAQ contains times (time buckets) from before the event window is actually open.</span>
<span class="sd">    As such, we cannot rely on the first peak of the ion chamber being the triggering peak. To correct for</span>
<span class="sd">    this we have a parameter `ic_delay_time_bucket` which essentially sets a threshold on peak centroid.</span>
<span class="sd">    All peaks before this time bucket are ignored, and the first peak after the time bucket is the triggering</span>
<span class="sd">    peak.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params: FribParameters</span>
<span class="sd">        Configuration parameters taht control the algorithm</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Peak | None</span>
<span class="sd">        Returns the triggering peak or None if there is no triggering peak found (not good)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ic_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ic_trace</span><span class="p">()</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Sort the peaks in ascending order, so that the first one we find</span>
    <span class="c1"># greater than our delay is the trigger.</span>
    <span class="n">ic_sorted_peaks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ic_peaks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">peak</span> <span class="ow">in</span> <span class="n">ic_sorted_peaks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">peak</span><span class="o">.</span><span class="n">centroid</span> <span class="o">&gt;</span> <span class="n">params</span><span class="o">.</span><span class="n">ic_delay_time_bucket</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">peak</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="spyral.trace.frib_event.preprocess_frib_traces" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">preprocess_frib_traces</span><span class="p">(</span><span class="n">traces</span><span class="p">,</span> <span class="n">baseline_window_scale</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>JIT-ed Method for pre-cleaning the trace data in bulk before doing trace analysis</p>
<p>These methods are more suited to operating on the entire dataset rather than on a trace by trace basis
It includes</p>
<ul>
<li>Removal of edge effects in traces (first and last time buckets can be noisy)</li>
<li>Baseline removal via fourier transform method (see J. Bradt thesis, pytpc library)</li>
</ul>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>traces</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A (2048, n) matrix where n is the number of traces and each column corresponds to a trace. This should be a copied
array, not a reference to an array in an hdf5 file</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>baseline_window_scale</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scale of the baseline filter used to perform a moving average over the basline</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ndarray</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new (2048, n) matrix which contains the traces with their baselines removed and edges smoothed</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>spyral/trace/frib_event.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">preprocess_frib_traces</span><span class="p">(</span>
    <span class="n">traces</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">baseline_window_scale</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;JIT-ed Method for pre-cleaning the trace data in bulk before doing trace analysis</span>

<span class="sd">    These methods are more suited to operating on the entire dataset rather than on a trace by trace basis</span>
<span class="sd">    It includes</span>

<span class="sd">    - Removal of edge effects in traces (first and last time buckets can be noisy)</span>
<span class="sd">    - Baseline removal via fourier transform method (see J. Bradt thesis, pytpc library)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    traces: ndarray</span>
<span class="sd">        A (2048, n) matrix where n is the number of traces and each column corresponds to a trace. This should be a copied</span>
<span class="sd">        array, not a reference to an array in an hdf5 file</span>
<span class="sd">    baseline_window_scale: float</span>
<span class="sd">        The scale of the baseline filter used to perform a moving average over the basline</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ndarray</span>
<span class="sd">        A new (2048, n) matrix which contains the traces with their baselines removed and edges smoothed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># transpose cause its easier to process</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="n">traces</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Smooth out the edges of the traces</span>
    <span class="n">traces</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">traces</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">traces</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">traces</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Remove peaks from baselines and replace with average</span>
    <span class="n">bases</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">traces</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="n">mean</span> <span class="o">&gt;</span> <span class="n">sigma</span> <span class="o">*</span> <span class="mf">1.5</span>
        <span class="n">row</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">])</span>

    <span class="c1"># Create the filter</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1024.0</span><span class="p">,</span> <span class="mf">1024.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">fil</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">window</span> <span class="o">/</span> <span class="n">baseline_window_scale</span><span class="p">))</span>
    <span class="n">transformed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">transformed</span> <span class="o">*</span> <span class="n">fil</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
    <span class="p">)</span>  <span class="c1"># Apply the filter -&gt; multiply in Fourier = convolve in normal</span>

    <span class="c1"># Make sure to transpose back into og format</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">traces</span> <span class="o">-</span> <span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
        <script src="../../../javascript/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>